---
title: Migrate to v12
description: Use this guide to migrate from React Flow v11 to v12.
---

# Migrate to v12

Like every major release, React Flow 12 introduces some breaking changes but also comes with a huge set of new features. Svelte Flow had a big impact on this release as well. While combing through each line of React Flow, we created framework agnostic helpers, found bugs, and made some under the hood improvements. All of these changes are baked into the v12 release as a welcome side-effect of that launch. 🙌🏻 We also **improved the performance for larger flows** with the help of Ivan and we are now using **TSDoc for a better developer experience** in your IDE.

## Main features

- **SSR / SSG**: You can render a flow on the server and hydrate on the client: [SSR/SSG guide](/learn/advanced-use/ssr-ssg-configuration)
  - Details: In v11, `width` and `height` were set by the library as soon as the nodes got measured. This still happens, but we are now using `computed.width` and `computed.height` to store this information. The `positionAbsolute` attribute also gets stored in `computed` . In the previous versions there was always a lot of confusion about `width` and `height`. It’s hard to understand, that you can’t use it for passing an actual width or height. It’s also not obvious that those attributes get added by the library. We think that the new implementation solves both of the problems: `width` and `height` are optional attributes that can be used to define dimensions and everything that is set by the library, is stored in `computed`.
- **Computing Flows:** The new hooks [`useHandleConnections`](/api-reference/hooks/use-handle-connections) and [`useNodesData`](/api-reference/hooks/use-nodes-data) and the new [`updateNode`](/api-reference/types/react-flow-instance#update-node) and [`updateNodeData`](/api-reference/types/react-flow-instance#update-node-data) functions (both are part of `useReactFlow`) can be used to manage the data flow between your nodes: [Computing flows guide](/learn/advanced-use/computing-flows)
  - Details: Working with reactive flows is super common. You update node A and want to react on those changes in the connected node B. Until now everyone had to come up with a custom solution. With this version we want to change this and give you performant helpers to handle this.
- **Dark mode and css variables:** React Flow now comes with a built-in dark mode, that can be toggled by using the new `colorMode` prop (”light”, “dark” or “system”): [Dark mode example](/examples/styling/dark-mode)
  - Details: With this version we want to make it easier to switch between dark and light modes and give you a better starting point for dark flows. If you pass colorMode=”dark”, we add the class name “dark” to the wrapper and use it to adjust the styling. To make the implementation for this new feature easier on our ends, we switched to CSS variables for most of the styles. These variables can also be used in user land to customize a flow.

## More features and updates

There is more! Besides the new main features, we added some minor things that were on our list for a long time. We also started to use TSDoc for a better DX. We already started to add some docs for some types and hooks which should improve the developer experience.

- **`useConnection` hook:** With this hook you can access the ongoing connection. For example, you can use it for colorizing handles styling a custom connection line based on the current start / end handles.
- **Controlled `viewport`:** This is an advanced feature. Possible use cases are to animate the viewport or round the transform for lower res screens for example. This features brings two new props: `viewport` and `onViewportChange`.
- **`ViewportPortal` component:** This makes it possible to render elements in the viewport without the need to implement a custom node.
- **`onDelete` handler**: We added a combined handler for `onDeleteNodes` and `onDeleteEdges` to make it easier to react to deletions.
- **`onBeforeDelete` handler**: With this handler you can prevent/ manage deletions.
- **`isValidConnection` prop:** This makes it possible to implement one validation function for all connections. It also gets called for programmatically added edges.
- **Background component**: add `patternClassName` to be able to style the background pattern by using a class name. This is useful if you want to style the background pattern with Tailwind for example.
- **`onMove` callback** gets triggered for library-invoked viewport updates (like fitView or zoom-in)
- **`deleteElements`** now returns deleted nodes and deleted edges
- add **`origin` attribute** for nodes
- add **`selectable` attribute** for edges
- Correct types for `BezierEdge`, `StepEdge`, `SmoothStepEdge` and `StraightEdge` components
- New edges created by the library only have `sourceHandle` and `targetHandle` attributes when those attributes are set. (We used to pass `sourceHandle: null` and `targetHandle: null`)
- Edges do not mount/unmount when their z-index change
- `nodeDragThreshold` is 1 by default instead of 0

## Breaking Changes

### 1. A new npm package name

The package `reactflow` has been renamed to `@xyflow/react` and it's not a default import anymore.

#### Old API

```js
// npm install reactflow
import ReactFlow from 'reactflow';
```

#### New API

```js
// npm install @xyflow/react
import { ReactFlow } from '@xyflow/react';

// you also need to adjust the style import
import '@xyflow/react/dist/style.css';

// or if you just want basic styles
import '@xyflow/react/dist/base.css';
```

### 2. Node attribute “computed”

All computed node values are now stored in `node.computed`. Besides the new package name, this is the biggest change. After React Flow measures your nodes, it writes the dimesions to `node.computed.width` and `node.computed.height`.

#### Old API

```js
// getting the measured width and height
const nodeWidth = node.width;
const nodeHeight = node.height;
```

#### New API

```js
// getting the measured width and height
const nodeWidth = node.computed.width;
const nodeHeight = node.computed.height;
```

### 3. Updating nodes and edges

We are not supporting node and edge updates with object mutations anymore. If you want to update a certain attribute, you need to create a new node / edge.

#### Old API

```js
setNodes((currentNodes) =>
  currentNodes.map((node) => {
    node.hidden = true;
    return node;
  }),
);
```

#### New API

```js
setNodes((currentNodes) =>
  currentNodes.map((node) => ({
    ...node,
    hidden: true,
  })),
);
```

### 4. Custom node props

We reanmed the `posX` and `posY` props to `positionAbsoluteX` and `positionAbsoluteY`

#### Old API

```js
function CustomNode({ posX, posY }) {
  ...
}
```

#### New API

```js
function CustomNode({ positionAbsoluteX, positionAbsoluteY }) {
  ...
}
```

### 5. `getNodesBounds` options

The type of the second param changed from `nodeOrigin` to `options.nodeOrigin` / `options.useRelativePosition`

#### Old API

```js
const bounds = getNodesBounds(nodes: Node[], nodeOrigin)
```

#### New API

```js
const bounds = getNodesBounds(nodes: Node[], { nodeOrigin })
```

### 6. Typescript changes for defining nodes and edges

We simplified types and fixed issues about functions where users could pass a NodeData generic. The new way is to define your own node type with a union of all your nodes. The big advantage of this is, that you can have multiple node types with different data structures and always be able to distinguish by checking the `node.type` attribute.

#### New API

```js
type NumberNode = Node<{ value: number }, 'number'>;
type TextNode = Node<{ text: string }, 'text'>;
type AppNode = NumberNode | TextNode;
```

You can then use the `AppNode` type as the following:

```js
const nodes: AppNode[] = [
  { id: '1', type: 'number', data: { value: 1 }, position: { x: 100, y: 100 } },
  { id: '2', type: 'text', data: { text: 'Hello' }, position: { x: 200, y: 200 } },
];
```

```js
const onNodesChange: onNodesChange<AppNode> = useCallback((changes) => setNodes(nds => applyChanges(changes, nds)), []);
```

You can read more about this in the [Typescript guide](/learn/advanced-use/typescript).

### 7. Rename `nodeInternals`

If you are using `nodeInternals` you need to rename it to `nodeLookup`.

#### Old API

```js
const node = useStore((s) => s.nodeInternals.get(id));
```

#### New API

```js
const node = useStore((s) => s.nodeLookup.get(id));
```

### 8. Removal of deprecated functions

We removed the following deprecated functions:

- `getTransformForBounds` (replaced by `getViewportForBounds`)
- `getRectOfNodes` (replaced by `getNodesBounds`)
- `project` (replaced by `screenToFlowPosition`)
- `getMarkerEndId`

### 9. Custom `applyNodeChanges` and `applyEdgeChanges``

If you wrote your own function for applying changes, you need to handle the new "replace" event. We removed the "reset" event and added a "replace" event that replaces specific nodes or edges.
